<html>
<head>
<title>::.. Virtex Admin - Área de Gerenciamento ..::</title>

<link href="template/default/estilos1.css" rel="stylesheet" type="text/css">
<script language="JavaScript" src="util.js"></script>

<script language="JavaScript">

function pagamentoHoje() {
   formulario.data_pagamento.value = hoje();
}

function pagamentoVencimento() {
   formulario.data_pagamento.value = '{vencimento}';
}

function verificaReagendamento() {
   formulario.data_reagendamento.disabled = !formulario.reagendar.checked;
}

function calculaValores() {

   tmpTotal = new String( formulario.valor_total.value );
   tmpPago  = new String( formulario.valor_pago.value );
   tmpDesc  = new String( formulario.desconto.value );
   tmpAcres = new String( formulario.acrescimo.value );
   tmpAmort = new String( formulario.amortizar.value );
   
   tt = RoundToNdp(tmpTotal.replace(/\,/,"."),2);
   tp = RoundToNdp(tmpPago.replace(/\,/,"."),2);
   td = RoundToNdp(tmpDesc.replace(/\,/,"."),2);
   ta = RoundToNdp(tmpAcres.replace(/\,/,"."),2);
   am = RoundToNdp(tmpAmort.replace(/\,/,"."),2);
   
   if( isNaN(td) ) td = 0;
   if( isNaN(ta) ) ta = 0;
   if( isNaN(am) ) am = 0;
   
   tr = tt - tp;
   tr = RoundToNdp(tr,2); // Tive que usar essa merda por conta de um pau no floatpoint do javascript!!! Bah
   tr = tr - td + ta;
   
   vp = RoundToNdp(tr - am,2); // Mesma merda
   
   if( am == 0 && tt-td+ta == tr ) { 
      formulario.status.value = "A";
   } else if( vp > 0 ) {
      formulario.status.value = "PP";
   } else {
      formulario.status.value = "PG";
   }
   
   formulario.status_fatura.value = formulario.status.value;
   
   debug = 0;
   if( debug ) {
      window.alert("TT: "+tt);
      window.alert("TP: "+tp);
      window.alert("TD: "+td);
      window.alert("TA: "+ta);
      window.alert("TR: "+tr);
      window.alert("AM: "+am);
      window.alert("VP: "+vp);
   }
   
   formulario.valor_total.value = numberFormat(tt);
   formulario.valor_pago.value = numberFormat(tp);
   formulario.desconto.value = numberFormat(td);
   formulario.acrescimo.value = numberFormat(ta);
   formulario.valor_restante.value = numberFormat(tr);
   formulario.amortizar.value = numberFormat(am);
   formulario.valor_pendente.value = numberFormat(vp);

   return true;
   
}



</script>
</head>

<body leftmargin="0" topmargin="0" marginwidth="0" marginheight="0">
<table width="100%" height="100%" border="0" cellpadding="0" cellspacing="0">
  <tr>
    <td align="center" valign="top"><table width="100%" border="0" cellspacing="0" cellpadding="0">
        <tr>
          <td>{ include file='menu_principal.html' }</td>
        </tr>
        <tr>
          <td height="100%" align="center" valign="middle"><table width="100%" border="0" cellspacing="0" cellpadding="0">
              <tr>
                <td align="CENTER" valign="MIDDLE"> <form name=formulario method="post" action="{PHP_SELF}" > 
                  <h1>Amortiza&ccedil;&atilde;o</h1>
                  <p> 
                    <input type="hidden" name="oper" value="{oper}">
                    <input type="hidden" name="sessao" value="{sessao}">
                    <input type="hidden" name="subsess" value="{subsess}">
                    <input type="hidden" name="p" value="{p}">
                    <input type="hidden" name="op" value="{op}">
                    <input type="hidden" name="id_cliente" value="{id_cliente}">
                    <input type="hidden" name="id_cliente_produto" value="{id_cliente_produto}">
                    <input type="hidden" name="data" value="{data}">
                    <input type="hidden" name="valor" value="{valor}">
                    <input type="hidden" name="descricao" value="{descricao}">
                    <input type="hidden" name="vt" value="{vt}">
                    <input type="hidden" name="vp" value="{vp}">
                    <!--input type="hidden" name="" value="{}"-->
                    <input type="hidden" name="status_fatura" value="">
                    <input type="hidden" name="popup" value="{popup}">
                  </p>
                  <table border=0  _bgcolor="#000000" cellspacing=1 cellpadding=1>
		<tr>
			<td align="center">
				<table border=0 width=390 cellspacing=0 cellpadding=0>
				   <tr><td><font color="#FF0000"><b>{sErro}<b></font></td></tr>
				</table>
				        <table border=0 width="390" bgcolor="#A0A0A0">
                          <tr bgcolor="#fafafa"> 
                            <td colspan=2><h2><font color="#000000">Fatura</font></h2></td>
                          </tr>
                          <tr> 
                            <td bgcolor="#FFFFFF" align="right" width="120"><p>Referente 
                                à:</p></td>
                            <td bgcolor="#FFFFFF"><p>{$lista_faturas.descricao}</p></td>
                          </tr>
                          <tr> 
                            <td bgcolor="#FFFFFF" align="right" width="120"><p>Vencimento:</p></td>
                            <td bgcolor="#FFFFFF"><p>{$lista_faturas.vencimento}</p></td>
                          </tr>
                          <tr> 
                            <td bgcolor="#FFFFFF" align="right" width="120"><p>Valor 
                                Total:</p></td>
                            <td bgcolor="#FFFFFF"><p> 
                                <input type="text" name="valor_total" value="{$lista_faturas.valor_total}" disabled="true">
                              </p></td>
                          </tr>
                          <tr> 
                            <td bgcolor="#FFFFFF" align="right" width="120"><p>Valor 
                                já pago(-):</p></td>
                            <td bgcolor="#FFFFFF"><p> 
                                <input type="text" name="valor_pago" value="{$lista_faturas.valor_pago}" disabled="1">
                              </p></td>
                          </tr>
                          <tr> 
                            <td bgcolor="#FFFFFF" align="right" width="120"><p>Desconto(-):</p></td>
                            <td bgcolor="#FFFFFF"><p> 
                                <input type="text" name="desconto" value="{$lista_faturas.desconto}" onChange="javascript:calculaValores();" onFocusOut="javascript:calculaValores();">
                              </p></td>
                          </tr>
                          <tr> 
                            <td bgcolor="#FFFFFF" align="right" width="120"><p>Acrescimo(+):</p></td>
                            <td bgcolor="#FFFFFF"><p> 
                                <input type="text" name="acrescimo" value="{acrescimo}" onChange="javascript:calculaValores();" onFocusOut="javascript:calculaValores();">
                              </p></td>
                          </tr>
                          <tr> 
                            <td bgcolor="#FFFFFF" align="right" width="120"><p>Valor 
                                a ser pago(=):</p></td>
                            <td bgcolor="#FFFFFF"><p> 
                                <input type="text" name="valor_restante" value="{valor_restante}" disabled=1>
                              </p></td>
                          </tr>
                          <tr> 
                            <td bgcolor="#FFFFFF" align="right" width="120"><p>Amortizar(-):</p></td>
                            <td bgcolor="#FFFFFF"><p> 
                                <input type="text" name="amortizar" value="{amortizar}" onChange="javascript:calculaValores();" onFocusOut="javascript:calculaValores();">
                              </p></td>
                          </tr>
                          <tr> 
                            <td bgcolor="#FFFFFF" align="right" width="120"><p>Valor 
                                Pendente(=):</p></td>
                            <td bgcolor="#FFFFFF"><p> 
                                <input type="text" name="valor_pendente" value="{valor_pendente}" disabled=1>
                              </p></td>
                          </tr>
                          <tr> 
                            <td bgcolor="#FFFFFF" align="right" width="120"><p>Status:</p></td>
                            <td bgcolor="#FFFFFF"><p>{status_select}</p></td>
                          </tr>
                          <tr> 
                            <td bgcolor="#FFFFFF" align="right" width="120"><p>Data 
                                do Pagamento:</p></td>
                            <td bgcolor="#FFFFFF"><p> 
                                <input type="text" name="data_pagamento" value="{data_pagamento}">
                                <input type="button" name="hoje" value="Hoje" onClick="javascript:pagamentoHoje();" &gt;&gt;" style="border: 1px solid #444444; font-size: 10px; background-color: #f3f3f3;">
                                <input type="button" name="venc" value="Venc." onClick="javascript:pagamentoVencimento();" &gt;&gt;" style="border: 1px solid #444444; font-size: 10px; background-color: #f3f3f3;">
                              </p></td>
                          </tr>
                          <tr bgcolor="#fafafa"> 
                            <td colspan=2><h2><font color="#000000">Opções</font></h2></td>
                          </tr>
                          <tr> 
                            <td bgcolor="#FFFFFF" align="right" width="120"> <p> 
                                <input type="checkbox" name="reagendar" value="1" onClick="javascript:verificaReagendamento();" onChange="javascript:verificaReagendamento();" {reagendamento_checked}>
                                re-agendar cobrança para dia: </p></td>
                            <td bgcolor="#FFFFFF"><input type="text" name="data_reagendamento" value="{data_reagendamento}" size=10 maxlength=10></td>
                          </tr>
                          <tr> 
                            <td bgcolor="#FFFFFF" align="right" width="120" valign="top"><p>Observações:</p></td>
                            <td bgcolor="#FFFFFF"><textarea name="observacoes" rows=5 cols=29>{observacoes}</textarea></td>
                          </tr>
                        </table>
				<hr size=1>
				<input name="botao_enviar" type="submit" class=input2 id="submit" value="{submit} &gt;&gt;" style="border: 1px solid #444444; font-size: 10px; background-color: #f3f3f3;">
			</td>
		</tr>
	</table>
	</form>
				
				</td>
              </tr>
            </table></td>
        </tr>
      </table></td>
  </tr>
  <tr>
    <td height="20" align="center" bgcolor="#BCD3C4"><table width="400" border="0" cellspacing="0" cellpadding="0">
        <tr>
          <td><div align="center"><font size="1" face="Verdana, Arial, Helvetica, sans-serif">&copy;
              Mosman Consultoria - Todos os Direitos Reservados</font></div></td>
        </tr>
      </table></td>
  </tr>
</table>
</body>


</html>
