<!-- CLIENTES_CADASTRO.HTML -->
<html>
<head>
<title>::.. Virtex Admin - Área de Gerenciamento ..::</title>
<link href="template/default/estilos1.css" rel="stylesheet" type="text/css">
<script type="text/javascript" src="template/default/ajax.js"></script>
<script type="text/javascript" src="template/default/ajax_validacoes.js"></script>
{literal}
<script language="JavaScript">

function checkForm(){
  var frm = document.cadastro;
	var pessoa     = frm.tipo_pessoa.value;
	var id_cliente = frm.id_cliente.value;
	var cpf_cnpj   = frm.cpf_cnpj.value;
	var rg_inscr   = frm.rg_inscr.value;
	var nome_razao = frm.nome_razao.value;

	//alert('PESSOA: '+pessoa);

	var erro = new String;

	/**
	 * Nome/razao não pode ser em branco.
	 */

	if( nome_razao.length == 0 ) {
	   erro = "Nome/Razao Social deve ser preenchido.";
	}

	/**
	 * Validacao de CPF/CNPJ
	 */
	if( erro.length == 0 ) {
		if(pessoa == 'F'){
			if( !validaCPF(cpf_cnpj) ) {
				erro = "CPF Invalido";
			}
			if( rg_inscr.length == 0 ) {
				erro = "O RG deve ser preenchido";
			}
		} else {
			if( cpf_cnpj.length == 0 || !validaCNPJ(cpf_cnpj) ) {
				 erro = "CNPJ Invalido";
			}
		}

		if( cpf_cnpj.length > 0 && existeDOCTO(cpf_cnpj,id_cliente) ) {
			if( pessoa == "F" ) {
				erro = "CPF";
			} else {
				erro = "CNPJ";
			}
			erro += " já cadastrado para outro cliente.";
		}

		if( rg_inscr.length > 0 && existeDOCTO(rg_inscr,id_cliente) ) {
			if( pessoa == "F" ) {
				erro = "RG já cadastrado";
			} else {
				erro = "INSCRICAO já cadastrada";
			}
			erro += " para outro cliente.";
		}
	}

	if(erro.length) {
		window.alert(erro);
		return false;
	}

	return confirmacao();

}


function validaCPF(cpf) {
	// cpf = document.cadastro.cpf_cnpj.value;
	erro = new String;

	if (cpf == "11111111111" || cpf == "22222222222" || cpf == "33333333333" || cpf == "44444444444" || cpf == "55555555555" || cpf == "66666666666" || cpf == "77777777777" || cpf == "88888888888" || cpf == "99999999999" || cpf == "00000000000"){
		erro += "Número de CPF/CNPJ Inválido! ";
	}

	if (cpf.length < 11) erro += "Sao necessarios 11 digitos para verificacao do CPF! ";
		//substituir os caracteres que não são números
    if(document.layers && parseInt(navigator.appVersion) == 4){
    	x = cpf.substring(0,3);
        x += cpf. substring (3,6);
        x += cpf. substring (6,9);
        x += cpf. substring (9,10);
        cpf = x;
    } else {
			cpf = cpf. replace (".","");
			cpf = cpf. replace (".","");
			cpf = cpf. replace ("-","");
		}

    var a = [];
    var b = new Number;
    var c = 11;
    for (i=0; i<11; i++) {
    	a[i] = cpf.charAt(i);
			if (i < 9) b += (a[i] * --c);
		}

    if ((x = b % 11) < 2) { a[9] = 0 } else { a[9] = 11-x }
    b = 0;
    c = 11;
    for (y=0; y<10; y++) b += (a[y] * c--);
		if ((x = b % 11) < 2) { a[10] = 0; } else { a[10] = 11-x; }
		if ((cpf.charAt(9) != a[9]) || (cpf.charAt(10) != a[10])){
			erro +="Digito verificador com problema!";
		}
		if (erro.length > 0){
			//alert(erro);
			return false;
		} else {
			return true;
		}

		return false;

}


function validaCNPJ(CNPJ) {
	//CNPJ = document.cadastro.cpf_cnpj.value;
	erro = new String;
	if (CNPJ.length < 18) erro += "É necessario preencher corretamente o número do CNPJ! ";

	if ((CNPJ.charAt(2) != ".") || (CNPJ.charAt(6) != ".") || (CNPJ.charAt(10) != "/") || (CNPJ.charAt(15) != "-")){
		if (erro.length == 0) erro += "É necessário preencher corretamente o número do CNPJ! ";
	}

	//substituir os caracteres que não são números
	if(document.layers && parseInt(navigator.appVersion) == 4){
		x = CNPJ.substring(0,2);
		x += CNPJ. substring (3,6);
		x += CNPJ. substring (7,10);
		x += CNPJ. substring (11,15);
		x += CNPJ. substring (16,18);
		CNPJ = x;
	} else {
		CNPJ = CNPJ. replace (".","");
		CNPJ = CNPJ. replace (".","");
		CNPJ = CNPJ. replace ("-","");
		CNPJ = CNPJ. replace ("/","");
	}

	var nonNumbers = /\D/;
	if (nonNumbers.test(CNPJ)) erro += "A verificação de CNPJ suporta apenas números! ";
	var a = [];
	var b = new Number;
	var c = [6,5,4,3,2,9,8,7,6,5,4,3,2];
	for (i=0; i<12; i++){
		a[i] = CNPJ.charAt(i);
		b += a[i] * c[i+1];
	}

	if ((x = b % 11) < 2) { a[12] = 0 } else { a[12] = 11-x }
	b = 0;
	for (y=0; y<13; y++) {
		b += (a[y] * c[y]);
	}
	if ((x = b % 11) < 2) { a[13] = 0; } else { a[13] = 11-x; }

	if ((CNPJ.charAt(12) != a[12]) || (CNPJ.charAt(13) != a[13])){
		erro +="Dígito verificador com problema!";
	}
	if (erro.length > 0){
		//alert(erro);
		return false;
	} else {
		return true;
	}

	return false;

}

function confirmacao(){
		return confirm("Tem certeza da alteração/cadastro deste cliente?");
}


//-->
</script>
{/literal}
</head>

<body leftmargin="0" topmargin="0" marginwidth="0" marginheight="0">

<table width="100%" height="10%" border="0" cellpadding="0" cellspacing="0">

</table></td>
        </tr>
        <tr>
          <td height="100%" align="center" valign="middle"><table width="100%" border="0" cellspacing="0" cellpadding="0">
              <tr>
                <td>
				{include file="cliente_menu.html"}

				</td>
             </tr>
              <tr>
                <td align="center" valign="middle"><p><font size="2" face="Verdana, Arial, Helvetica, sans-serif"><strong>
                  <h1>{$titulo} Cliente</h1><br>
                  {if count($erros) }
                  {foreach item=a from=$erros}
                  <font size="2" face="arial" color="#FF0000">Mensagem de Erro:<b> {$a}</b><br></font>
				  {/foreach}
                  {/if}

                  </strong></font><p></p>
                  <form action="{$smarty.server.PHP_SELF}" method="post" name="cadastro" id="cadastro" onSubmit="return checkForm();">
                    <input type="hidden" name="op" value="{$op}">
                     <input type="hidden" name="id_cliente" value="{$id_cliente}">
                     <input type="hidden" name="acao" value="{$acao}">



                    <table width="500" border="0" align="center" cellpadding="0" cellspacing="1" class=main>
                      <tr>
                        <td colspan="2"><table width="100%" border="0" cellspacing="1" cellpadding="0">
                            <tr>
                              <td width="47%"><p><font size="1" face="Verdana, Arial, Helvetica, sans-serif">Nome/Raz&atilde;o
                                  Social</font></p></td>
                              <td width="38%"><p><font size="1" face="Verdana, Arial, Helvetica, sans-serif">Pessoa</font></p></td>
                            </tr>
                            <tr>
                              <td><p><font size="1" face="Verdana, Arial, Helvetica, sans-serif">
                                  <input  name="nome_razao" type="text"  id="nome_razao" value="{$nome_razao}" size="50" maxlength="50" onBlur="this.style.backgroundColor='#FFFFFF'" onFocus="this.style.backgroundColor='#F7F9F7'" >
                                  </font></p></td>
                              <td><p><font size="1" face="Verdana, Arial, Helvetica, sans-serif">
                                  <SELECT name='tipo_pessoa'>
                                  {foreach key=id item=nome from=$lista_tp_pessoa}

                                    <option value='{$id}'{if $id == $tipo_pessoa}SELECTED{/if}>{$nome}</option>


                                  {/foreach}

								</SELECT>
                                  </font></p></td>
                            </tr>
                          </table></td>
                      </tr>
                      <tr>
                        <td colspan="2"><table width="100%" border="0" cellspacing="1" cellpadding="0">
                            <tr>
                              <td width="33%" height="14"> <p><font size="1" face="Verdana, Arial, Helvetica, sans-serif">RG</font></p></td>
                              <td width="33%"><p><font size="1" face="Verdana, Arial, Helvetica, sans-serif">Expedi&ccedil;&atilde;o
                                  </font></p></td>
                              <td width="33%"><p><font size="1" face="Verdana, Arial, Helvetica, sans-serif">CPF/CNPJ
                                  </font></p></td>
                            </tr>
                            <tr>
                              <td><input  name="rg_inscr" type="text" id="rg_inscr" value="{$rg_inscr}" maxlength="20" onFocus="this.style.backgroundColor='#F7F9F7'" onBlur="this.style.backgroundColor='#FFFFFF'"></td>
                              <td><input  name="rg_expedicao" type="text" id="rg_expedicao" value="{$rg_expedicao}" maxlength="10" onFocus="this.style.backgroundColor='#F7F9F7'" onBlur="this.style.backgroundColor='#FFFFFF'"></td>
                              <td><input  name="cpf_cnpj" type="text" id="cpf_cnpj" value="{$cpf_cnpj}" maxlength="25"  onfocus="this.style.backgroundColor='#F7F9F7'" onBlur="this.style.backgroundColor='#FFFFFF'">
                                 </td>
                            </tr>

                          </table></td>
                      </tr>
                      <tr>
                        <td colspan="2"><table width="100%" border="0" cellspacing="1" cellpadding="0">
                            <tr>
                              <td width="46%"><p><font size="1" face="Verdana, Arial, Helvetica, sans-serif">Email</font></p></td>
                              <td width="54%">&nbsp;</td>
                            </tr>
                            <tr>
                              <td colspan="2"><input  name="email"type="text" id="email4" value="{$email}" size="50" maxlength="255" onFocus="this.style.backgroundColor='#F7F9F7'" onBlur="this.style.backgroundColor='#FFFFFF'"></td>
                            </tr>
                          </table></td>
                      </tr>
                      <tr>
                        <td colspan="2"><table width="100%" border="0" cellspacing="0" cellpadding="1">
                            <tr>
                              <td width="33%"><p><font size="1" face="Verdana, Arial, Helvetica, sans-serif">Endere&ccedil;o</font></p></td>
                              <td width="33%">&nbsp;</td>
                              <td width="34%">&nbsp;</td>
                            </tr>
                            <tr>
                              <td colspan="3"><input  name="endereco"type="text"  id="endereco3" value="{$endereco}" size="70" maxlength="50" onFocus="this.style.backgroundColor='#F7F9F7'" onBlur="this.style.backgroundColor='#FFFFFF'">
                              </td>
                            </tr>
                            <tr>
                              <td><p><font size="1" face="Verdana, Arial, Helvetica, sans-serif">Complemento</font></p></td>
                              <td><p><font size="1" face="Verdana, Arial, Helvetica, sans-serif">Bairro<br></font></p></td>
                              <td rowspan="2"><font size="1" face="Verdana, Arial, Helvetica, sans-serif">&nbsp;</font></td>
                            </tr>
                            <tr>
                              <td><font size="1" face="Verdana, Arial, Helvetica, sans-serif">
                                <input  name="complemento"type="text"  id="complemento4" value="{$complemento}" maxlength="20" onFocus="this.style.backgroundColor='#F7F9F7'" onBlur="this.style.backgroundColor='#FFFFFF'">
                                </font></td>
                              <td><font size="1" face="Verdana, Arial, Helvetica, sans-serif">
                                <input  name="bairro" type="text"  id="bairro2" value="{$bairro}" maxlength="15" onFocus="this.style.backgroundColor='#F7F9F7'" onBlur="this.style.backgroundColor='#FFFFFF'">
                                </font></td>
                            </tr>
                            <tr>
                              <td><p><font size="1" face="Verdana, Arial, Helvetica, sans-serif">Cidade
                                  </font></p></td>
                              <td width="20"></td>
                              <td><p><font size="1" face="Verdana, Arial, Helvetica, sans-serif">CEP</font></p></td>
                            </tr>
                            <tr>
                              <td><font size="1" face="Verdana, Arial, Helvetica, sans-serif">

							  <select name="id_cidade">
							  {foreach item=a from=$cidades_disponiveis}
							  	<option value='{$a.id_cidade}' {if $a.id_cidade == $id_city}SELECTED{/if}>{$a.cidade} - {$a.uf}</option>
							  {/foreach}
							  </select>
                                </font></td>
                              <td width="20"></td>
                              <td><font size="1" face="Verdana, Arial, Helvetica, sans-serif">
                                <input  name="cep"type="text"  id="cep2" value="{$cep}" maxlength="10" onFocus="this.style.backgroundColor='#F7F9F7'" onBlur="this.style.backgroundColor='#FFFFFF'">
                                </font></td>
                            </tr>
                            <tr>
                              <td><p><font size="1" face="Verdana, Arial, Helvetica, sans-serif">Telefone
                                  Comercial </font></p></td>
                              <td><p><font size="1" face="Verdana, Arial, Helvetica, sans-serif">Telefone
                                  Residencial </font></p></td>
                              <td><p><font size="1" face="Verdana, Arial, Helvetica, sans-serif">Celular
                                  <br>
                                  </font></p></td>
                            </tr>
                            <tr>
                              <td><font size="1" face="Verdana, Arial, Helvetica, sans-serif">
                                <input  name="fone_comercial" type="text"  id="fone_comercial" value="{$fone_comercial}" maxlength="15" onFocus="this.style.backgroundColor='#F7F9F7'" onBlur="this.style.backgroundColor='#FFFFFF'">
                                </font></td>
                              <td><font size="1" face="Verdana, Arial, Helvetica, sans-serif">
                                <input  name="fone_residencial" type="text"  id="fone_residencial" value="{$fone_residencial}" maxlength="15" onFocus="this.style.backgroundColor='#F7F9F7'" onBlur="this.style.backgroundColor='#FFFFFF'">
                                </font></td>
                              <td><font size="1" face="Verdana, Arial, Helvetica, sans-serif">
                                <input  name="fone_celular"type="text"  id="fone_celular" value="{$fone_celular}" maxlength="15" onFocus="this.style.backgroundColor='#F7F9F7'" onBlur="this.style.backgroundColor='#FFFFFF'">
                                </font></td>
                            </tr>
                          </table></td>
                      </tr>
                      <tr>
                        <td colspan="2"><table width="100%" border="0" cellspacing="1" cellpadding="0">
                            <tr>
                              <td colspan="3"><font size="1" face="Verdana, Arial, Helvetica, sans-serif">Contato
                                <br>
                                </font> <input  name="contato" type="text"  id="contato" value="{$contato}" size="50" maxlength="20" onFocus="this.style.backgroundColor='#F7F9F7'" onBlur="this.style.backgroundColor='#FFFFFF'"></td>
                            </tr>
                            <tr>
                              <td width="33%">&nbsp; </td>
                              <td width="33%">&nbsp;</td>
                              <td width="33%">&nbsp;</td>
                            </tr>
                          </table></td>
                      </tr>
                      <tr>
                        <td colspan="2"><table width="100%" border="0" cellspacing="1" cellpadding="0">
                            <tr>
                              <td colspan="3"><p><font size="1" face="Verdana, Arial, Helvetica, sans-serif">Outras
                                  Informa&ccedil;&otilde;es</font></p></td>
                            </tr>
                            <tr>
                              <td width="33%"><p><font size="1" face="Verdana, Arial, Helvetica, sans-serif">Banco<br>
                                  <input  name="banco" type="text"  id="banco" value="{$banco}" maxlength="20" onFocus="this.style.backgroundColor='#F7F9F7'" onBlur="this.style.backgroundColor='#FFFFFF'">
                                  </font></p></td>
                              <td width="33%"><p><font size="1" face="Verdana, Arial, Helvetica, sans-serif">Ag&ecirc;ncia<br>
                                  <input  name="agencia" type="text"  id="agencia" value="{$agencia}" maxlength="10" onFocus="this.style.backgroundColor='#F7F9F7'" onBlur="this.style.backgroundColor='#FFFFFF'">
                                  </font></p></td>
                              <td width="33%"><p><font size="1" face="Verdana, Arial, Helvetica, sans-serif">Conta
                                  Corrente<br>
                                  <input  name="conta_corrente" type="text"  id="conta_corrente3" value="{$conta_corrente}" maxlength="10" onFocus="this.style.backgroundColor='#F7F9F7'" onBlur="this.style.backgroundColor='#FFFFFF'">
                                  </font></p></td>
                            </tr>
                          </table></td>
                      </tr>
                      <tr>
                        <td colspan="2"><table width="100%" border="0" cellspacing="1" cellpadding="0">
                            <tr>
                              <td width="33%">&nbsp;</td>
                              <td width="33%">&nbsp;</td>
                              <td width="33%">&nbsp;</td>
                            </tr>
                            <tr>
                              <td><p><font size="1" face="Verdana, Arial, Helvetica, sans-serif">Status
                                  do Contrato<br>
                                  <select name='ativo'>
									     {foreach key=id item=nome from=$lista_ativo}
                                    		<option value='{$id}'{if $id == $ativo}SELECTED{/if}>{$nome}</option>
                               		 	 {/foreach}
									</select>
                                  </font></p></td>
                              <td><p><font size="1" face="Verdana, Arial, Helvetica, sans-serif">Data
                                  de Pagamento<br>
                                  <select name='dia_pagamento'>
                             	  			{foreach key=id item=nome from=$lista_dia_pagamento}
                                    				<option value='{$id}'{if $id == $dia_pagamento}SELECTED{/if}>{$nome}</option>
                               	  			{/foreach}
                               	   </select>
                                  </font></p></td>
                              <td>&nbsp;</td>
                            </tr>
                          </table></td>
                      </tr>
                      <tr>
                        <td colspan="2"><table width="100%" border="0" cellspacing="1" cellpadding="0">
                            <tr>
                              <td width="33%">&nbsp;</td>
                              <td width="33%">&nbsp;</td>
                              <td width="33%">&nbsp;</td>
                            </tr>
                            <tr>
                              <td colspan="3"><p><font size="1" face="Verdana, Arial, Helvetica, sans-serif">Observa&ccedil;&otilde;es
                                  </font></p></td>
                            </tr>
                            <tr>
                              <td colspan="3"><textarea name="obs" cols="80" rows="8" onFocus="this.style.backgroundColor='#F7F9F7'" onBlur="this.style.backgroundColor='#FFFFFF'">{$obs}</textarea></td>
                            </tr>
                          </table></td>
                      </tr>
                      <tr>
                        <td colspan="2"> <table width="100%" border="0" cellspacing="1" cellpadding="0">
                            <tr>
                              <td width="33%">&nbsp;</td>
                              <td width="33%"><div align="center">
                                  <input name="cadastro_cliente" type="submit" id="cadastro_cliente2" value={$titulo}>
                                </div></td>
                              <td width="33%">&nbsp;</td>
                            </tr>
                          </table></td>
                      </tr>
                      <tr>
                        <td width="47%">&nbsp;</td>
                        <td width="53%">&nbsp;</td>
                      </tr>
                      <tr>
                        <td width="47%">&nbsp;</td>
                        <td width="53%">&nbsp;</td>
                      </tr>
                    </table>
                  </form>
                  <p>&nbsp;</p></td>
              </tr>
            </table></td>
        </tr>
      </table></td>
  </tr>
</table>
</body>


</html>

